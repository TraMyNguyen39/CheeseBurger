@page
@model ManageStaffModel
@{
	ViewData["Title"] = "ManageStaff";
}
<link rel="stylesheet" href="~/css/manage-user.css" asp-append-version="true" />

@{
	int CntStaff = 0;
}

<div class="main__information">
	<div class="main__information-detail">
		<div class="d-flex justify-content-between align-items-center mb-5">
			<form class="menu-sort-staff-role" method="get">
				<label style="margin-left: 2%">Chức vụ: </label>
				<select name="roleBy" class="menu-sort-staff-role-box" id="role-select">
					<option value="all">Tất cả</option>
					<option value="admin">Quản trị viên</option>
					<option value="chef">Nhân viên đầu bếp</option>
					<option value="shipper">Nhân viên giao hàng</option>					
				</select>
				<input name="sortBy" value="@Model.sortBy" type="hidden" />
				<input name="search" value="@Model.searchText" type="hidden" />
				<input type="submit" style="visibility: hidden; width:0" />
			</form>
			<form class="menu-sort-staff" method="get">
				<label>Sắp xếp theo: </label>
				<select name="sortBy" class="menu-sort-staff-box" id="sort-select">
					<option value="all">Tất cả</option>
					<option value="name-asc">Tăng theo tên</option>
					<option value="name-desc">Giảm theo tên</option>
				</select>
				<input name="roleBy" value="@Model.roleBy" type="hidden" />
				<input name="search" value="@Model.searchText" type="hidden" />
				<input type="submit" style="visibility: hidden; width:0" />
			</form>
			<form class="menu-search-staff-box" method="get">
				<input class="search-staff-box-input" type="text" name="search" placeholder="Nhập tên cần tìm">
				<input class="search-staff-box-hidden" name="sortBy" value="@Model.sortBy" type="hidden" />
				<input class="search-staff-box-hidden" name="roleBy" value="@Model.roleBy" type="hidden" />
				<button type="submit" class="search-staff-box-btn">
					<i class="fas fa-magnifying-glass"></i>
				</button>
			</form>
		</div>
		<table class="content-table">
			<thead>
				<tr class="tr">
					<th class="STT col-1">STT</th>
					<th class="ID col-1">Mã NV</th>
					<th class="Name col-3">Họ tên</th>
					<th class="Role col-2">Chức vụ</th>
					<th class="SDT col-2">Số điện thoại</th>
					<th class="Option__eye col-1">Xem</th>
					<th class="Option__pencil col-1">Sửa</th>
					<th class="Option__ban col-1">Xoá</th>
				</tr>
			</thead>
			<tbody>
				@foreach (var staff in Model.staffs)
				{
					@if (staff.StaIsStaff == true && staff.StaIsDeleted == false)
					{
						<tr class="tr">
							<td class="STT">@(++CntStaff)</td>
							<td class="ID">@(100 + (@staff.StaID))</td>
							<td class="Name">@staff.StaName</td>
							<td class="Role">@staff.StaRoleName</td>
							<td class="SDT">@staff.StaPhone</td>
							<td class="Option__eye" data-id="@staff.StaID"> <i class="fas fa-eye"></i></td>
							<td class="Option__pencil" data-id="@staff.StaID"> <i class="fas fa-pencil-alt"></i></td>
							<td class="Option__ban" data-id="@staff.StaID">  <i class="fas fa-ban"></i></td>
						</tr>
					}
				}			
			</tbody>
		</table>
		<div class="page-pagination">
			<div class="pagination">
				<a href="#"><i class="fas fa-angle-double-left"></i></a>
				<a href="#">1</a>
				<a href="#" class="active">2</a>
				<a href="#">3</a>
				<a href="#">4</a>
				<a href="#">5</a>
				<a href="#">6</a>
				<a href="#"><i class="fas fa-angle-double-right"></i></a>
			</div>
		</div>
	</div>
</div>
<!-- Update staff -->
<form method="post" asp-page="ManageStaff" asp-page-handler="Update">
	<div class="modal__account-update">
		<div class="modal__account-information">
			<div class="button__exit">
				<div class="exit__surround">
					<i class="fas fa-times"></i>
				</div>
			</div>
			<div class="modal__account-details">			
				<div class="modal__account-label d-flex align-items-center">
					<p class="modal__label-cate">Cập nhật tài khoản</p>
					<p class="modal__label-main" id="name"></p>
				</div>
				<div class="account__name">
					<p class="label">Họ và tên</p>
					<input class="form-control mr-sm-2" type="search" aria-label="Search" name="Name" required="required" readonly="readonly">
				</div>
				<div class="account__position-categories d-flex justify-content-between">
					<div class="account__position col-12">
						<p class="label">Chức vụ</p>
						<div class="form__comboBoxList" style="font-size: 20px">
							<form method="post">
								<select name="combobox_Item" required="required" style="border-radius: 3px">
									<option value="Khách hàng">Khách hàng</option>
									<option value="Quản trị viên">Quản trị viên</option>
									<option value="Nhân viên đầu bếp">Nhân viên đầu bếp</option>
									<option value="Nhân viên giao hàng">Nhân viên giao hàng</option>
								</select>
							</form>
						</div>
					</div>
				</div>
				<div class="account__email-telephone d-flex justify-content-between">
					<div class="account__email col-6">
						<p class="label">Địa chỉ email</p>
						<input class="form-control mr-sm-2" type="search" aria-label="Search" name="Email" required="required" readonly="readonly">
					</div>
					<div class="account__telephone col-6">
						<p class="label">Số điện thoại</p>
						<input class="form-control mr-sm-2" type="search" aria-label="Search" name="Phone" required="required" readonly="readonly">
					</div>
				</div>
				<div class="account__city-district d-flex justify-content-between">
					<div class="account__city-details col-6">
						<p class="label">Tỉnh (thành phố)</p>
						<input class="form-control mr-sm-2" type="search" placeholder="Đà Nẵng" readonly>
					</div>
					<div class="account__district-details col-6">
						<p class="label">Quận (huyện)</p>
						<input class="form-control mr-sm-2" type="search" aria-label="Search" name="District" required="required" readonly="readonly">
					</div>
				</div>
				<div class="account__ward-address d-flex justify-content-between">
					<div class="account__ward col-6">
						<p class="label">Phường (xã)</p>
						<input class="form-control mr-sm-2" type="search" aria-label="Search" name="Ward" required="required" readonly="readonly">
					</div>
					<div class="account__adress col-6">
						<p class="label">Số nhà</p>
						<input class="form-control mr-sm-2" type="search" aria-label="Search" name="HouseNum" required="required" readonly="readonly">
					</div>
				</div>
				<div class="button__account-save">
					<button class="" type="submit">Cập nhật thông tin tài khoản</button>
				</div>
			</div>
			<input type="hidden" name="StaID" class="modal__staff-id" value="" />
		</div>
	</div>
</form>
<!-- End Update staff -->
<!-- Full Information -->
<form method="post" asp-page="ManageStaff">
	<div class="modal__info-full">
		<div class="modal__info-details">
			<div class="button__exit d-flex justify-content-end">
				<div class="exit__surround">
					<i class="fas fa-times"></i>
				</div>
			</div>
			<div class="modal__staff-details">
				<p class="modal__label-main">
					<input name="StaID" type="hidden" />
					<div class="modal__staff-label d-flex align-items-center">
						<p class="modal__label-cate">Chi tiết tài khoản</p>
						<p class="modal__label-main" id="name"></p>
					</div>
				</p>
				<div class="staff__info-full d-flex">
					<div class="staff__info-key col-3">
						<p class="categories__text" for="id">Mã người dùng:</p>
						<p class="categories__text" for="name">Họ và tên:</p>
						<p class="categories__text" for="gender">Giới tính:</p>
						<p class="categories__text" for="role">Chức vụ</p>
						<p class="categories__text" for="phone">Số điện thoại:</p>
						<p class="categories__text" for="email">Email:</p>
						<p class="categories__text" for="address">Địa chỉ:</p>						
					</div>
					<div class="staff__info-value col-9">
						<p class="categories__text" id="id"></p>
						<p class="categories__text" id="name"></p>
						<p class="categories__text" id="gender"></p>
						<p class="categories__text" id="role"></p>
						<p class="categories__text" id="phone"></p>
						<p class="categories__text" id="email"></p>
						<p class="categories__text" id="address"></p>
					</div>
				</div>
				@*<button class="submit-btn btn-save" type="submit">Thay đổi thông tin tài khoản</button>*@
			</div>
		</div>
	</div>
</form>
<script src="~/js/manage-staff.js"></script>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script type="text/javascript">
	$(document).ready(function () {
		$('.Option__eye').on('click', function () {
			var id = $(this).data('id');
			$.ajax({
				type: 'GET',
				data: { id: id },
				url: '@Url.Page("ManageStaff", "Find")',
				success: function (result) {
					$('.modal__info-full #id').text(result.id + 100);
					$('.modal__info-full #name').text(result.name);
					$('.modal__info-full #gender').text(result.gender ? "Nam" : "Nữ");
					$('.modal__info-full #phone').text(result.phone);
					$('.modal__info-full #role').text(result.rolnamee);
					$('.modal__info-full #email').text(result.email);
					$('.modal__info-full #address').text(result.address);
				},
				error: function (xhr, textStatus, errorThrown) {
					alert('Error loading ingredient: ' + errorThrown);
				}
			});
		});

		$('.Option__pencil').on('click', function () {
			var id = $(this).data('id');
			$.ajax({
				type: 'GET',
				data: { id: id },
				url: '@Url.Page("ManageStaff", "Find")',
				success: function (result) {
					$('.modal__account-update #name').text(result.name);
					$('.modal__account-update input[name="StaID"]').val(result.id);
					$('.modal__account-update input[name="Name"]').val(result.name);
					$('.modal__account-update input[name="Email"]').val(result.email);
					$('.modal__account-update input[name="Phone"]').val(result.phone);
					$('.modal__account-update input[name="District"]').val(result.diss);
					$('.modal__account-update input[name="Ward"]').val(result.wrdd);
					$('.modal__account-update input[name="HouseNum"]').val(result.housenum);
				},
				error: function (xhr, textStatus, errorThrown) {
					alert('Error loading ingredient: ' + errorThrown);
				}
			});
		});
	});
</script>
<!-- End Full Information -->
